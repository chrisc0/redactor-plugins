!function(a){a.Redactor.prototype.breadcrumb=function(){return{messageBox:null,init:function(){this.core.element().after('<p class="redactor_message_box redactor_breadcrumb" id="redactor_breadcrumb-'+this.uuid+'"><i class="fa fa-code icon icon-code"></i>&nbsp;<span></span></p>'),this.breadcrumb.messageBox=a("#redactor_breadcrumb-"+this.uuid),this.core.editor().on("keyup.redactor-plugin-counter click sync",a.proxy(this.breadcrumb.handleChange,this))},handleChange:function(b){var c=this.selection.current(),d=a(c).clone(),e=(d.find('*[data-verified="redactor"]'),d.closest("div.redactor-editor"),[]);if(a(c).parent().is("div.redactor-editor"))e.push(a(d)[0].tagName);else for(var f=a(c);a(f)[0]&&void 0!==f.parent()&&!f.is("div.redactor-editor");)e.push(a(f)[0].tagName),f=f.parent();e=e.reverse(),this.breadcrumb.messageBox.children("span").html(e.join("&nbsp;&raquo;&nbsp;").toLowerCase())}}}}(jQuery),function(a){a.Redactor.prototype.contrast=function(){return{init:function(){a.extend(this.opts.shortcuts,{f5:{func:"contrast.toggle",params:[]}})},toggle:function(){console.log("contrast toggle"),this.core.editor().toggleClass("redactor-editor_contrast")}}}}(jQuery),function(a){a.Redactor.prototype.download=function(){return{init:function(){var a=this.button.add("download","Download");this.button.addCallback(a,this.download.download)},download:function(){a('<a target="_blank" download="content.html" href="data:text/html,'+encodeURI(this.code.get())+'"></a>').get(0).click()}}}}(jQuery),function(a){a.Redactor.prototype.imagepx=function(){return{init:function(){this.core.element().on("modalOpened.callback.redactor",a.proxy(this.imagepx.modalOpened,this))},modalOpened:function(b,c){var d=this;"image-edit"==b&&(a("#redactor-image-link").attr("type","url"),a("#redactor-modal .redactor-modal-tab-area section").last().before(function(){function b(b,c){var d=a("<div>"),e=a("<label>"),f=a('<input name="'+c+'" type="number" min="0" step="1">');return e.text(b),d.append([e,f]),d}return a("<section>").addClass("dimension").append([b("Width","width"),b("Height","height")])}()),a(d.observe.image).attr("width")&&a('section.dimension input[name="width"]').val(a(d.observe.image).attr("width")),a(d.observe.image).attr("height")&&a('section.dimension input[name="height"]').val(a(d.observe.image).attr("height")),a('section.dimension input[type="number"]').each(function(){a(this).on("change keyup",function(b){switch(b.target.name){case"width":a(d.observe.image).attr("width",a(b.target).val());break;case"height":a(d.observe.image).attr("height",a(b.target).val())}})}))}}}}(jQuery),function(a){a.Redactor.prototype.imageurl=function(){return{"url-tab":String()+'<form id="insert-image-form" class="redactor-modal-tab" data-title="URL"><section><label>URL</label><input type="url" id="image-url-input" aria-label="Insert Image by URL" /></section><section><button id="redactor-modal-button-action" type="submit">Insert</button><button id="redactor-modal-button-cancel">Cancel</button></section></form>',init:function(){a.extend(this.opts.modal,{image:this.opts.modal.image+this.imageurl["url-tab"]}),this.core.element().on("modalOpened.callback.redactor",a.proxy(this.imageurl.load,this))},load:function(){var b=this;a("#redactor-modal-image-droparea").length&&a("#insert-image-form").submit(function(c){c.preventDefault(),b.image.insert({url:a("#image-url-input").val()}),b.modal.close(),b.selection.restore()})}}}}(jQuery),function(a){a.Redactor.prototype.replacer=function(){return{getTemplate:function(){return String()+'<form id="redactor-modal-replacer"><section><p>Search and replace found text.</p><div><label>Search</label><input type="text" size="5" value="" id="redactor-replacer-find" required /></div><div><label>Replace</label><input type="text" size="5" value="" id="redactor-replacer-replace" required /></div><div class="options"><div class="ignore-case"><label>Ignore Case</label><input type="checkbox" id="redactor-replacer-ignore-case" /></div></div><footer><button id="redactor-modal-button-action" type="submit">Replace</button><button id="redactor-modal-button-cancel">Cancel</button></footer></section></form>'},init:function(){a.extend(this.opts.shortcuts,{"ctrl+f":{func:"replacer.show",params:[]}})},show:function(){var b=this;this.modal.addTemplate("replacer",this.replacer.getTemplate()),this.modal.load("replacer",this.lang.get("replacer")||"Replacer",400),a("#redactor-modal-replacer").submit(function(a){a.preventDefault(),b.replacer.replace()}),this.sel&&this.sel.toString()&&(a("#redactor-replacer-find").val(this.sel.toString()),a("#redactor-replacer-replace").focus()),this.selection.save(),this.modal.show(),a("#redactor-modal-replacer").focus()},replace:function(){function b(a,b,c,d){return c.replace(a instanceof RegExp?a:new RegExp(a,d),b)}var c=a("#redactor-replacer-find").val(),d=a("#redactor-replacer-replace").val(),e=a("#redactor-replacer-ignore-case").is(":checked");c&&d&&this.insert.set(b(c,d,this.code.get(),"g"+(e?"i":""))),this.modal.close(),this.selection.restore()}}}}(jQuery),function(a){var b=!1;a(window).keydown(function(a){18==a.which&&(b=!0)}).keyup(function(a){18==a.which&&(b=!1)}),a.Redactor.prototype.speek=function(){var c,d=window.speechSynthesis.getVoices();return window.speechSynthesis.onvoiceschanged=function(a){d=window.speechSynthesis.getVoices()},{getTemplate:function(){var b=a(document.createElement("section"));b.attr("id","redactor-modal-speek"),b.append("<p>Listen as you wish.</p>"),b.append('<label for="voice">Voice</label>'),b.append(a('<div style="margin-bottom:1em">').append(document.createElement("select"))),a.each(d,function(c,d){b.find("select").attr("id","voice").attr("name","voice").append(a('<option value="'+d.name+'">'+d.name+"</option>"))});var c=a('<div class="options"></div>');return c.append('<label for="volume">Volume</label><input data-varname="speechVolume" type="range" min="0" max="1" step="0.1" name="volume" id="volume" value="1">'),c.append('<label for="rate">Rate</label><input data-varname="speechRate" type="range" min="0" max="1" step="0.1" name="Rate" id="rate" value="1">'),c.append('<label for="pitch">Pitch</label><input data-varname="speechPitch" type="range" min="0" max="1" step="0.1" name="pitch" id="pitch" value="1">'),c.append('<section style="margin-top:1em"><button id="redactor-modal-button-cancel">Close</button></section>'),b.append(c),a(b)[0].outerHTML},init:function(){if(!(!1 in window)){var b=this.button.add("speek","Listen");this.button.addCallback(b,this.speek.clicked),a.extend(this.opts.shortcuts,{esc:{func:"speek.shutup",params:[]}}),this.core.element().on("modalClosed.callback.redactor",a.proxy(this.speek.shutup,this))}},clicked:function(){return b?void this.speek.show():void this.speek.speek()},speek:function(){var b=window.speechSynthesis.speaking;this.speek.shutup();var e=this.button.get("speek"),f=this.opts.speechVoice||"Vicki";if(!b){var g=this.code.get(),h=[];a(g).each(function(b,c){h.push(a(c).text())}),g=h.join(" "),c=new SpeechSynthesisUtterance,c.text=g,c.lang=this.opts.speechLang||"en-US",c.voice=d.filter(function(a){return a.name==f})[0],c.rate=void 0!==this.opts.speechRate?this.opts.speechRate:1,c.pitch=void 0!==this.opts.speechPitch?this.opts.speechPitch:1,c.volume=void 0!==this.opts.speechVolume?this.opts.speechVolume:1,c.onend=c.onerror=function(){e.removeClass("speaking")},c.onstart=c.onresume=function(){e.addClass("speaking")},window.speechSynthesis.speak(c),e.addClass("speaking")}},show:function(){var b=this.button.get("speek"),c=this;this.modal.addTemplate("choose-voice",this.speek.getTemplate()),this.modal.load("choose-voice",this.lang.get("choose-voice")||"Choose Voice",400),a("#redactor-modal-speek select").on("change",function(){var b=a(this).val();c.speek.vocalChange(b)}),a("#redactor-modal-speek select").val(c.opts.speechVoice),a("#redactor-modal-speek #volume, #redactor-modal-speek #rate, #redactor-modal-speek #pitch").each(function(){a(this).on("change",function(){b=c.button.get("speek"),c.opts[a(this).data("varname")]=a(this).val(),c.speek.shutup(),c.speek.speek(),b.addClass("speaking")}).val(c.opts[a(this).data("varname")])}),this.selection.save(),this.modal.show()},close:function(){this.modal.close(),this.speek.shutup(),this.speek.speek(),this.selection.restore()},vocalChange:function(a){var b=this.button.get("speek"),c=d.filter(function(b){return b.name==a})[0];c&&(this.opts.speechVoice=c.name,this.speek.shutup(),this.speek.speek(),b.addClass("speaking"))},shutup:function(){var a=window.speechSynthesis.speaking?!0:!1;window.speechSynthesis.cancel();var b=this.button.get("speek");if(c)try{c.cancel()}catch(d){}return window.speechSynthesis.cancel(),c=null,b.removeClass("speaking"),a}}}}(jQuery),function(a){a.Redactor.prototype.syntax=function(){return{offlineMode:!1,editor:null,editorDOM:null,prettyContent:null,init:function(){var b=this;void 0===b.opts.aceLoaded&&(b.opts.aceLoaded=!1),b.opts.aceLoaded||(this.opts=a.extend({aceUseSoftTabs:!0,aceTabSize:4,aceUseWrapMode:!0,aceHighlightActiveLine:!0,aceReadOnly:!1,aceTheme:"ace/theme/chrome",aceMode:"ace/mode/html"},this.opts),"undefined"==typeof ace?(b.syntax.offlineMode=!0,a.getScript(b.opts.aceOfflineSource,function(){b.syntax.handleLoaded()})):b.syntax.handleLoaded())},handleLoaded:function(){var b=this,c=b.$textarea;b.$textarea.after('<div hidden="true" class="redactor__modx-code-pretty-content" rows="4" style="display:none"></div>'),b.syntax.prettyContent=b.$textarea.parent().children("div.redactor__modx-code-pretty-content").attr("id","redactor__modx-code-pretty-content"+b.uuid),b.syntax.editorDOM=a(document.getElementById("redactor__modx-code-pretty-content"+b.uuid)),b.syntax.offlineMode&&b.opts.aceOfflineSource&&(ace.config.set("modePath",b.opts.assetsUrl+"lib/ace/"),ace.config.set("workerPath",b.opts.assetsUrl+"lib/ace/"),ace.config.set("themePath",b.opts.assetsUrl+"lib/ace/")),b.syntax.editor=ace.edit("redactor__modx-code-pretty-content"+b.uuid);var d=b.syntax.editor;d.setTheme(b.opts.aceTheme),d.getSession().setMode(b.opts.aceMode),d.getSession().setUseWorker(void 0===b.opts.useWorkers?b.opts.useWorkers:!1),d.setValue(c.val()),void 0!==b.opts.aceUseSoftTabs&&d.getSession().setUseSoftTabs(b.opts.aceUseSoftTabs),void 0!==b.opts.aceTabSize&&parseInt(b.opts.aceTabSize)&&d.getSession().setTabSize(parseInt(b.opts.aceTabSize)),void 0!==b.opts.aceUseWrapMode&&d.getSession().setUseWrapMode(b.opts.aceUseWrapMode),void 0!==b.opts.aceHighlightActiveLine&&d.setHighlightActiveLine(b.opts.aceHighlightActiveLine),void 0!==b.opts.aceReadOnly&&d.setReadOnly(b.opts.aceReadOnly);var e=b.button.get("html");b.button.addCallback(e,b.syntax.sourceCallback),d.on("change",function(a){b.source.$textarea.val(d.getValue())}),void 0!==b.opts.aceFontSize&&b.syntax.editorDOM.css({fontSize:b.opts.aceFontSize}),b.opts.aceLoaded=!0},sourceCallback:function(a,b){var c=this,d=c.syntax.editor,e=c.syntax.editorDOM.attr("hidden");if("undefined"!=typeof e&&e!==!1){var f=c.source.$textarea.height();c.source.$textarea.hide(),d.setValue(c.source.$textarea.val()),c.syntax.prettyContent.removeAttr("hidden").show().height(f),d.resize()}else c.insert.set(d.getValue(),!1),c.syntax.editorDOM.hide(),c.syntax.prettyContent.attr("hidden","true")}}}}(jQuery),function(a){a.Redactor.prototype.wym=function(){return{init:function(){this.core.editor().addClass("redactor-editor_wym")}}}}(jQuery),function(a){a.Redactor.prototype.zoom=function(){return{init:function(){void 0===this.opts.zoomLevel&&(this.opts.zoomLevel=0),a.extend(this.opts.shortcuts,{"ctrl+=":{func:"zoom.zoom",params:[1]},"ctrl+-":{func:"zoom.zoom",params:[-1]}})},zoom:function(a){this.opts.zoomLevel+=a,this.opts.zoomLevel=Math.min(3,this.opts.zoomLevel),this.opts.zoomLevel=Math.max(0,this.opts.zoomLevel),this.$editor.attr("data-zoom",this.opts.zoomLevel)}}}}(jQuery);